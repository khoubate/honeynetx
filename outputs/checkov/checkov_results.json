{"check_type": "terraform", "results": {"failed_checks": [{"check_id": "CKV_AZURE_10", "bc_check_id": "BC_AZR_NETWORKING_3", "check_name": "Ensure that SSH access is restricted from the internet", "check_result": {"result": "FAILED", "evaluated_keys": ["security_rule/[0]/access", "security_rule/[0]/direction", "security_rule/[0]/protocol", "security_rule/[0]/destination_port_range", "security_rule/[0]/destination_port_ranges", "security_rule/[0]/source_address_prefix", "security_rule/[0]/source_address_prefixes"]}, "code_block": [[20, "resource \"azurerm_network_security_group\" \"honeynetx-nsg\" {\n"], [21, "  name                = \"${var.prefix}-nsg\"\n"], [22, "  location            = azurerm_resource_group.honeynetx-rg.location\n"], [23, "  resource_group_name = azurerm_resource_group.honeynetx-rg.name\n"], [24, "\n"], [25, "  security_rule {\n"], [26, "    name                       = \"AllowSSH\"\n"], [27, "    priority                   = 100\n"], [28, "    direction                  = \"Inbound\"\n"], [29, "    access                     = \"Allow\"\n"], [30, "    protocol                   = \"Tcp\"\n"], [31, "    source_port_range          = \"*\"\n"], [32, "    destination_port_range     = \"22\"\n"], [33, "    source_address_prefix      = \"*\"\n"], [34, "    destination_address_prefix = \"*\"\n"], [35, "  }\n"], [36, "\n"], [37, "  security_rule {\n"], [38, "    name                       = \"AllowWebInterface\"\n"], [39, "    priority                   = 110\n"], [40, "    direction                  = \"Inbound\"\n"], [41, "    access                     = \"Allow\"\n"], [42, "    protocol                   = \"Tcp\"\n"], [43, "    source_port_range          = \"*\"\n"], [44, "    destination_port_range     = \"64297\"\n"], [45, "    source_address_prefix      = \"*\"\n"], [46, "    destination_address_prefix = \"*\"\n"], [47, "  }\n"], [48, "}\n"]], "file_path": "/terraform/main.tf", "file_abs_path": "/src/terraform/main.tf", "repo_file_path": "/src/terraform/main.tf", "file_line_range": [20, 48], "resource": "azurerm_network_security_group.honeynetx-nsg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.NSGRuleSSHAccessRestricted", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-3", "details": [], "check_len": null, "definition_context_file_path": "/src/terraform/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "prefix", "path": "/src/terraform/variable.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "prefix", "path": "/src/terraform/variable.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.honeynetx-rg", "path": "/src/terraform/main.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/src/terraform/variable.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.honeynetx-rg", "path": "/src/terraform/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_178", "bc_check_id": "BC_AZR_GENERAL_102", "check_name": "Ensure linux VM enables SSH with keys for secure communication", "check_result": {"result": "FAILED", "evaluated_keys": ["admin_ssh_key/[0]/public_key"]}, "code_block": [[76, "resource \"azurerm_linux_virtual_machine\" \"main\" {\n"], [77, "  name                = \"${var.prefix}-vm\"\n"], [78, "  location            = azurerm_resource_group.honeynetx-rg.location\n"], [79, "  resource_group_name = azurerm_resource_group.honeynetx-rg.name\n"], [80, "  size                = var.vm_size\n"], [81, "  admin_username      = var.admin_username\n"], [82, "  admin_password      = var.admin_password\n"], [83, "  network_interface_ids = [\n"], [84, "    azurerm_network_interface.honeynetx-vm-nic.id,\n"], [85, "  ]\n"], [86, "\n"], [87, "  disable_password_authentication = false\n"], [88, "\n"], [89, "  os_disk {\n"], [90, "    caching              = \"ReadWrite\"\n"], [91, "    storage_account_type = \"Standard_LRS\"\n"], [92, "  }\n"], [93, "\n"], [94, "  source_image_reference {\n"], [95, "    publisher = \"Canonical\"\n"], [96, "    offer     = \"0001-com-ubuntu-server-jammy\"\n"], [97, "    sku       = \"22_04-lts-gen2\"\n"], [98, "    version   = \"latest\"\n"], [99, "  }\n"], [100, "}\n"]], "file_path": "/terraform/main.tf", "file_abs_path": "/src/terraform/main.tf", "repo_file_path": "/src/terraform/main.tf", "file_line_range": [76, 100], "resource": "azurerm_linux_virtual_machine.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.LinuxVMUsesSSH", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-178", "details": [], "check_len": null, "definition_context_file_path": "/src/terraform/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "prefix", "path": "/src/terraform/variable.tf", "module_connection": false}], "admin_username": [{"type": "variable", "name": "admin_username", "path": "/src/terraform/variable.tf", "module_connection": false}], "admin_password": [{"type": "variable", "name": "admin_password", "path": "/src/terraform/variable.tf", "module_connection": false}], "size": [{"type": "variable", "name": "vm_size", "path": "/src/terraform/variable.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/src/terraform/variable.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.honeynetx-rg", "path": "/src/terraform/main.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "prefix", "path": "/src/terraform/variable.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.honeynetx-rg", "path": "/src/terraform/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_50", "bc_check_id": "BC_AZR_GENERAL_14", "check_name": "Ensure Virtual Machine Extensions are not Installed", "check_result": {"result": "FAILED", "evaluated_keys": ["allow_extension_operations"]}, "code_block": [[76, "resource \"azurerm_linux_virtual_machine\" \"main\" {\n"], [77, "  name                = \"${var.prefix}-vm\"\n"], [78, "  location            = azurerm_resource_group.honeynetx-rg.location\n"], [79, "  resource_group_name = azurerm_resource_group.honeynetx-rg.name\n"], [80, "  size                = var.vm_size\n"], [81, "  admin_username      = var.admin_username\n"], [82, "  admin_password      = var.admin_password\n"], [83, "  network_interface_ids = [\n"], [84, "    azurerm_network_interface.honeynetx-vm-nic.id,\n"], [85, "  ]\n"], [86, "\n"], [87, "  disable_password_authentication = false\n"], [88, "\n"], [89, "  os_disk {\n"], [90, "    caching              = \"ReadWrite\"\n"], [91, "    storage_account_type = \"Standard_LRS\"\n"], [92, "  }\n"], [93, "\n"], [94, "  source_image_reference {\n"], [95, "    publisher = \"Canonical\"\n"], [96, "    offer     = \"0001-com-ubuntu-server-jammy\"\n"], [97, "    sku       = \"22_04-lts-gen2\"\n"], [98, "    version   = \"latest\"\n"], [99, "  }\n"], [100, "}\n"]], "file_path": "/terraform/main.tf", "file_abs_path": "/src/terraform/main.tf", "repo_file_path": "/src/terraform/main.tf", "file_line_range": [76, 100], "resource": "azurerm_linux_virtual_machine.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AzureInstanceExtensions", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azr-general-14", "details": [], "check_len": null, "definition_context_file_path": "/src/terraform/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "prefix", "path": "/src/terraform/variable.tf", "module_connection": false}], "admin_username": [{"type": "variable", "name": "admin_username", "path": "/src/terraform/variable.tf", "module_connection": false}], "admin_password": [{"type": "variable", "name": "admin_password", "path": "/src/terraform/variable.tf", "module_connection": false}], "size": [{"type": "variable", "name": "vm_size", "path": "/src/terraform/variable.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/src/terraform/variable.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.honeynetx-rg", "path": "/src/terraform/main.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "prefix", "path": "/src/terraform/variable.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.honeynetx-rg", "path": "/src/terraform/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_1", "bc_check_id": "BC_AZR_NETWORKING_1", "check_name": "Ensure Azure Instance does not use basic authentication(Use SSH Key Instead)", "check_result": {"result": "FAILED", "evaluated_keys": ["disable_password_authentication"]}, "code_block": [[76, "resource \"azurerm_linux_virtual_machine\" \"main\" {\n"], [77, "  name                = \"${var.prefix}-vm\"\n"], [78, "  location            = azurerm_resource_group.honeynetx-rg.location\n"], [79, "  resource_group_name = azurerm_resource_group.honeynetx-rg.name\n"], [80, "  size                = var.vm_size\n"], [81, "  admin_username      = var.admin_username\n"], [82, "  admin_password      = var.admin_password\n"], [83, "  network_interface_ids = [\n"], [84, "    azurerm_network_interface.honeynetx-vm-nic.id,\n"], [85, "  ]\n"], [86, "\n"], [87, "  disable_password_authentication = false\n"], [88, "\n"], [89, "  os_disk {\n"], [90, "    caching              = \"ReadWrite\"\n"], [91, "    storage_account_type = \"Standard_LRS\"\n"], [92, "  }\n"], [93, "\n"], [94, "  source_image_reference {\n"], [95, "    publisher = \"Canonical\"\n"], [96, "    offer     = \"0001-com-ubuntu-server-jammy\"\n"], [97, "    sku       = \"22_04-lts-gen2\"\n"], [98, "    version   = \"latest\"\n"], [99, "  }\n"], [100, "}\n"]], "file_path": "/terraform/main.tf", "file_abs_path": "/src/terraform/main.tf", "repo_file_path": "/src/terraform/main.tf", "file_line_range": [76, 100], "resource": "azurerm_linux_virtual_machine.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AzureInstancePassword", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-1", "details": [], "check_len": null, "definition_context_file_path": "/src/terraform/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "prefix", "path": "/src/terraform/variable.tf", "module_connection": false}], "admin_username": [{"type": "variable", "name": "admin_username", "path": "/src/terraform/variable.tf", "module_connection": false}], "admin_password": [{"type": "variable", "name": "admin_password", "path": "/src/terraform/variable.tf", "module_connection": false}], "size": [{"type": "variable", "name": "vm_size", "path": "/src/terraform/variable.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/src/terraform/variable.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.honeynetx-rg", "path": "/src/terraform/main.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "prefix", "path": "/src/terraform/variable.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.honeynetx-rg", "path": "/src/terraform/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_149", "bc_check_id": "BC_AZR_GENERAL_84", "check_name": "Ensure that Virtual machine does not enable password authentication", "check_result": {"result": "FAILED", "evaluated_keys": ["disable_password_authentication"]}, "code_block": [[76, "resource \"azurerm_linux_virtual_machine\" \"main\" {\n"], [77, "  name                = \"${var.prefix}-vm\"\n"], [78, "  location            = azurerm_resource_group.honeynetx-rg.location\n"], [79, "  resource_group_name = azurerm_resource_group.honeynetx-rg.name\n"], [80, "  size                = var.vm_size\n"], [81, "  admin_username      = var.admin_username\n"], [82, "  admin_password      = var.admin_password\n"], [83, "  network_interface_ids = [\n"], [84, "    azurerm_network_interface.honeynetx-vm-nic.id,\n"], [85, "  ]\n"], [86, "\n"], [87, "  disable_password_authentication = false\n"], [88, "\n"], [89, "  os_disk {\n"], [90, "    caching              = \"ReadWrite\"\n"], [91, "    storage_account_type = \"Standard_LRS\"\n"], [92, "  }\n"], [93, "\n"], [94, "  source_image_reference {\n"], [95, "    publisher = \"Canonical\"\n"], [96, "    offer     = \"0001-com-ubuntu-server-jammy\"\n"], [97, "    sku       = \"22_04-lts-gen2\"\n"], [98, "    version   = \"latest\"\n"], [99, "  }\n"], [100, "}\n"]], "file_path": "/terraform/main.tf", "file_abs_path": "/src/terraform/main.tf", "repo_file_path": "/src/terraform/main.tf", "file_line_range": [76, 100], "resource": "azurerm_linux_virtual_machine.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.VMDisablePasswordAuthentication", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/ensure-azure-virtual-machine-does-not-enable-password-authentication", "details": [], "check_len": null, "definition_context_file_path": "/src/terraform/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "prefix", "path": "/src/terraform/variable.tf", "module_connection": false}], "admin_username": [{"type": "variable", "name": "admin_username", "path": "/src/terraform/variable.tf", "module_connection": false}], "admin_password": [{"type": "variable", "name": "admin_password", "path": "/src/terraform/variable.tf", "module_connection": false}], "size": [{"type": "variable", "name": "vm_size", "path": "/src/terraform/variable.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/src/terraform/variable.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.honeynetx-rg", "path": "/src/terraform/main.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "prefix", "path": "/src/terraform/variable.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.honeynetx-rg", "path": "/src/terraform/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_119", "bc_check_id": "BC_AZR_NETWORKING_36", "check_name": "Ensure that Network Interfaces don't use public IPs", "check_result": {"result": "FAILED", "entity": {"azurerm_network_interface": {"honeynetx-vm-nic": {"__end_line__": 74, "__start_line__": 63, "ip_configuration": [{"name": ["internal"], "private_ip_address_allocation": ["Dynamic"], "public_ip_address_id": ["azurerm_public_ip.honeynetx-vm-ip.id"], "subnet_id": ["azurerm_subnet.internal.id"]}], "location": ["East US"], "name": ["honeynetx-vm-nic"], "resource_group_name": ["honeynetx-resources"], "__address__": "azurerm_network_interface.honeynetx-vm-nic"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[63, "resource \"azurerm_network_interface\" \"honeynetx-vm-nic\" {\n"], [64, "  name                = \"${var.prefix}-vm-nic\"\n"], [65, "  location            = azurerm_resource_group.honeynetx-rg.location\n"], [66, "  resource_group_name = azurerm_resource_group.honeynetx-rg.name\n"], [67, "\n"], [68, "  ip_configuration {\n"], [69, "    name                          = \"internal\"\n"], [70, "    subnet_id                     = azurerm_subnet.internal.id\n"], [71, "    private_ip_address_allocation = \"Dynamic\"\n"], [72, "    public_ip_address_id          = azurerm_public_ip.honeynetx-vm-ip.id\n"], [73, "  }\n"], [74, "}\n"]], "file_path": "/terraform/main.tf", "file_abs_path": "/src/terraform/main.tf", "repo_file_path": "/src/terraform/main.tf", "file_line_range": [63, 74], "resource": "azurerm_network_interface.honeynetx-vm-nic", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/ensure-that-network-interfaces-dont-use-public-ips", "details": [], "check_len": null, "definition_context_file_path": "/src/terraform/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "prefix", "path": "/src/terraform/variable.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "prefix", "path": "/src/terraform/variable.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.honeynetx-rg", "path": "/src/terraform/main.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/src/terraform/variable.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.honeynetx-rg", "path": "/src/terraform/main.tf", "module_connection": false}]}}]}, "summary": {"passed": 9, "failed": 6, "skipped": 0, "parsing_errors": 0, "resource_count": 9, "checkov_version": "3.2.411"}}